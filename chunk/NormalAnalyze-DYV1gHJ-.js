import{s as D}from"./node-xlsx-DLXZ95PR.js";import{d as $,e as q,B as G,S as J,f as K,T as X,g as Y,h as tt}from"./ant-design-vue-DHBJgo7H.js";import{r as g,P as w,U as E,c as l,R as p,F as S,E as I,W as O,a0 as V,Z as N,Q as W}from"./@vue-CnPkYVV3.js";import"./xlsx-BSlZAFvl.js";import"./dayjs-CXLFLwF_.js";import"./@babel-D6Xak2o6.js";import"./@ant-design-CboYqvPR.js";import"./@ctrl-DOFZgDuz.js";import"./lodash-es-By6oLbc8.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./throttle-debounce-CUWDS_la.js";import"./dom-align-CRCehRfe.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";import"./vue-types-C5fUfLeo.js";const et={style:{width:"600px"}},at={style:{width:"600px"}},v=60,T=92.5,ot=.8,wt={__name:"NormalAnalyze",setup(nt){const j=T*2,B={年级:"grade",班级:"class",学生姓名:"name",语文:"chinese",数学:"math",英语:"english",两科总分:"total"},P=g([]),F=g([]),z=g([]),y=g({chinese:0,math:0,total:0}),H=g([{title:"班级",dataIndex:"class"},{title:"人数",dataIndex:"count"},{title:"平均分",dataIndex:"average"},{title:"及格人数",dataIndex:"passCount"},{title:"及格率",dataIndex:"passRate"},{title:"关爱人数",dataIndex:"careCount"},{title:"关爱率",dataIndex:"careRate"},{title:"特优人数",dataIndex:"topCount"},{title:"特优率",dataIndex:"topRate"}]),r=g([{key:"chinese",name:"语文",data:[]},{key:"math",name:"数学",data:[]},{key:"english",name:"英语",data:[]},{key:"two",name:"两科",data:[]},{key:"three",name:"三科",data:[]}]),A={types:[{description:"Excel",accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}],excludeAcceptAllOption:!0,multiple:!1};function L(){return window.showOpenFilePicker(A).then(([o])=>o.getFile()).then(o=>o.arrayBuffer()).then(o=>D.parse(o)).then(o=>{P.value=o;const s=o[0].data[0];F.value=[{title:"序号",dataIndex:"no",customRender:({index:n})=>`${n+1}`},...s.map(n=>({title:n,dataIndex:B[n]})),{title:"两科总分",dataIndex:"total"}],z.value=o.map(M)})}function M(o){const s={...o},n=o.data[0];return s.data.shift(),s.data=s.data.map(i=>{const t={};return i.forEach((m,d)=>t[B[n[d]]]=m),typeof t.chinese=="number"&&typeof t.math=="number"?t.total=t.chinese+t.math:t.total=t.chinese,i.push(t.total),t}),s}function Q(){const o=P.value;r.value.forEach(c=>c.data=[]);let[s,n,i]=[[],[],[]],t={name:"校平",count:0,care:{chinese:0,math:0,total:0},score:{chinese:[],math:[],total:[]},chinese:{score:0,passCount:0,topCount:0,careCount:0,average:0,passRate:0,topRate:0,careRate:0},math:{score:0,passCount:0,topCount:0,careCount:0,average:0,passRate:0,topRate:0,careRate:0},english:{score:0,passCount:0,average:0,passRate:0},two:{score:0,passCount:0,topCount:0,careCount:0,average:0,passRate:0,topRate:0,careRate:0},three:{passCount:0,passRate:0}};for(let c=0;c<o.length;c++){const{data:C}=o[c];for(let u=0;u<C.length;u++){let[e,x,Z,b,k,_,h]=C[u];h||(h=_),!(typeof b!="number"||typeof k!="number")&&(s.push(b),n.push(k),i.push(h))}}const m=(c,C)=>C-c,d=parseInt(ot*s.length);t.care.chinese=s.sort(m)[d],t.care.math=n.sort(m)[d],t.care.total=i.sort(m)[d],y.value=t.care;for(let c=0;c<o.length;c++){const{name:C,data:u}=o[c];let e={name:"",count:0,chinese:{score:0,passCount:0,topCount:0,careCount:0,average:0,passRate:0,topRate:0,careRate:0},math:{score:0,passCount:0,topCount:0,careCount:0,average:0,passRate:0,topRate:0,careRate:0},english:{score:0,passCount:0,average:0,passRate:0},two:{score:0,passCount:0,topCount:0,careCount:0,average:0,passRate:0,topRate:0,careRate:0},three:{passCount:0,passRate:0}};for(let x=0;x<u.length;x++){let[Z,b,k,_,h,f,R]=u[x];R||(R=f,f=0),!(typeof _!="number"||typeof h!="number")&&(e.name=b,e.count++,e.two.score+=R,e.chinese.score+=_,e.math.score+=h,e.english.score+=f,_>=v&&(e.chinese.passCount++,_>=T&&e.chinese.topCount++,h>=v&&(e.two.passCount++,R>=j&&e.two.topCount++,f&&f>=v&&e.three.passCount++)),h>=v&&(e.math.passCount++,h>=T&&e.math.topCount++),f&&f>=v&&e.english.passCount++,_<=t.care.chinese&&e.chinese.careCount++,h<=t.care.math&&e.math.careCount++,R<=t.care.total&&e.two.careCount++)}t.count+=e.count,t.two.score+=e.two.score,t.two.passCount+=e.two.passCount,t.two.topCount+=e.two.topCount,t.two.careCount+=e.two.careCount,t.three.passCount+=e.three.passCount,t.chinese.score+=e.chinese.score,t.chinese.passCount+=e.chinese.passCount,t.chinese.topCount+=e.chinese.topCount,t.chinese.careCount+=e.chinese.careCount,t.math.score+=e.math.score,t.math.passCount+=e.math.passCount,t.math.topCount+=e.math.topCount,t.math.careCount+=e.math.careCount,t.english.score+=e.english.score,t.english.passCount+=e.english.passCount,e.two.average=a(e.two.score/e.count/2),e.two.passRate=a(e.two.passCount/e.count*100),e.two.careRate=a((1-e.two.careCount/e.count)*100),e.two.topRate=a(e.two.topCount/e.count*100),e.three.passRate=a(e.three.passCount/e.count*100),e.chinese.average=a(e.chinese.score/e.count),e.chinese.passRate=a(e.chinese.passCount/e.count*100),e.chinese.careRate=a((1-e.chinese.careCount/e.count)*100),e.chinese.topRate=a(e.chinese.topCount/e.count*100),e.math.average=a(e.math.score/e.count),e.math.passRate=a(e.math.passCount/e.count*100),e.math.careRate=a((1-e.math.careCount/e.count)*100),e.math.topRate=a(e.math.topCount/e.count*100),e.english.average=a(e.english.score/e.count),e.english.passRate=a(e.english.passCount/e.count*100),r.value[0].data.push({class:e.name,count:e.count,...e.chinese}),r.value[1].data.push({class:e.name,count:e.count,...e.math}),r.value[2].data.push({class:e.name,count:e.count,...e.english}),r.value[3].data.push({class:e.name,count:e.count,...e.two}),r.value[4].data.push({class:e.name,count:e.count,...e.three})}t.two.average=a(t.two.score/t.count/2),t.two.passRate=a(t.two.passCount/t.count*100),t.two.careRate=a((1-t.two.careCount/t.count)*100),t.two.topRate=a(t.two.topCount/t.count*100),t.three.passRate=a(t.three.passCount/t.count*100),t.chinese.average=a(t.chinese.score/t.count),t.chinese.passRate=a(t.chinese.passCount/t.count*100),t.chinese.careRate=a((1-t.chinese.careCount/t.count)*100),t.chinese.topRate=a(t.chinese.topCount/t.count*100),t.math.average=a(t.math.score/t.count),t.math.passRate=a(t.math.passCount/t.count*100),t.math.careRate=a((1-t.math.careCount/t.count)*100),t.math.topRate=a(t.math.topCount/t.count*100),t.english.average=a(t.english.score/t.count),t.english.passRate=a(t.english.passCount/t.count*100),r.value[0].data.push({class:t.name,count:t.count,...t.chinese}),r.value[1].data.push({class:t.name,count:t.count,...t.math}),r.value[2].data.push({class:t.name,count:t.count,...t.english}),r.value[3].data.push({class:t.name,count:t.count,...t.two}),r.value[4].data.push({class:t.name,count:t.count,...t.three})}function U(){const o=[];r.value.forEach(n=>{const i=[["班级","人数","平均分","及格人数","及格率","关爱人数","关爱率","特优人数","特优率"]];n.data.forEach(t=>i.push([t.class,t.count,t.average,t.passCount,t.passRate,t.careCount,t.careRate,t.topCount,t.topRate])),o.push({name:n.name,data:i})});const s=D.build(o);window.showOpenFilePicker(A).then(([n])=>n.createWritable()).then(n=>{n.write(s),n.close(),q.success("下载成功！")})}function a(o){return Math.round(o*100)/100}return(o,s)=>{const n=G,i=J,t=K,m=$,d=Y,c=tt,C=X;return w(),E(S,null,[l(m,null,{default:p(()=>[l(t,{span:24},{default:p(()=>[l(i,{wrap:""},{default:p(()=>[l(n,{type:"primary",onClick:s[0]||(s[0]=()=>L())},{default:p(()=>[I("导入")]),_:1}),l(n,{type:"primary",onClick:s[1]||(s[1]=()=>Q())},{default:p(()=>[I("分析")]),_:1}),l(n,{type:"primary",onClick:s[2]||(s[2]=()=>U())},{default:p(()=>[I("下载")]),_:1})]),_:1})]),_:1})]),_:1}),l(m,null,{default:p(()=>[l(t,{span:12},{default:p(()=>[O("div",et,[l(C,null,{default:p(()=>[(w(!0),E(S,null,V(z.value,u=>(w(),W(c,{key:u.name,tab:u.name},{default:p(()=>[l(d,{size:"small",pagination:!1,columns:F.value,dataSource:u.data},null,8,["columns","dataSource"])]),_:2},1032,["tab"]))),128))]),_:1})])]),_:1}),l(t,{span:12},{default:p(()=>[O("div",at,[O("div",null,"关爱分数：语文："+N(y.value.chinese)+" 数学："+N(y.value.math)+" 两科："+N(y.value.total),1),l(C,null,{default:p(()=>[(w(!0),E(S,null,V(r.value,u=>(w(),W(c,{key:u.key,tab:u.name},{default:p(()=>[l(d,{size:"small",pagination:!1,columns:H.value,dataSource:u.data},null,8,["columns","dataSource"])]),_:2},1032,["tab"]))),128))]),_:1})])]),_:1})]),_:1})],64)}}};export{wt as default};
